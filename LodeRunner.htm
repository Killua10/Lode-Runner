<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Lode Runner par Ariel Sashcov et Mohamed Cherifi</title>
  <link rel="stylesheet" type="text/css" href="" />
  <!-- Code JavaScript local -->
  <script type="text/javascript">
	var objCanvas = null;
	var objC2D = null;
	var objCycleAnimation = null;
	var objImageFond = null;
  var tabMappe = [ ['F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F'],
                   ['F','F','F','F','O','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F'],
                   ['M','M','M','M','M','M','M','E','M','M','M','M','M','M','M','F','F','F','F','F','F','F','F','F','F','F','F','F'],
                   ['F','F','F','F','F','F','F','E','C','C','C','C','C','C','C','C','C','C','F','F','F','F','F','O','F','F','F','F'],
                   ['F','F','F','F','F','F','F','E','F','F','F','F','M','M','E','F','F','F','M','M','M','M','M','M','M','E','M','M'],
                   ['F','F','F','F','F','F','F','E','F','F','F','F','M','M','E','F','F','F','F','F','F','F','F','F','F','E','F','F'],
                   ['F','F','F','F','F','F','F','E','F','F','F','F','M','M','E','F','F','F','F','F','F','F','O','F','F','E','F','F'],
                   ['M','M','E','M','M','M','M','M','F','F','F','F','M','M','M','M','M','M','M','M','E','M','M','M','M','M','M','M'],
                   ['F','F','E','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','E','F','F','F','F','F','F','F'],
                   ['F','F','E','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','F','E','F','F','F','F','F','F','F'],
                   ['M','M','M','M','M','M','M','M','M','E','M','M','M','M','M','M','M','M','M','M','E','F','F','F','F','F','F','F'],
                   ['F','F','F','F','F','F','F','F','F','E','F','F','F','F','F','F','F','F','F','F','E','F','F','F','F','F','F','F'],
                   ['F','F','F','F','F','F','F','O','F','E','C','C','C','C','C','C','C','C','C','C','E','F','F','F','O','F','F','F'],
                   ['F','F','F','F','E','M','M','M','M','M','M','F','F','F','F','F','F','F','F','F','M','M','M','M','M','M','M','E'],
                   ['F','F','F','F','E','F','F','F','F','F','F','F','F','F','F','F','F','F','O','F','F','F','F','F','F','F','F','E'],
                   ['M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M'],
                   ['B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B','B']  ];

    function initAnimation() {
        objCanvas = document.getElementById('monCanvas');
        objC2D = objCanvas.getContext('2d');
        initImageFond();
	      dessiner(); // Dessiner une première fois
        animer();

    }

    // Aller chercher les image de fond
    function initImageFond() {
        objImageFond = new Image();
        objImageFond.src = 'img/F.png';

				objImageEchelle = new Image();
        objImageEchelle.src = 'img/E.png';

				objImageCorde = new Image();
        objImageCorde.src = 'img/C.png';

				objImageMur = new Image();
        objImageMur.src = 'img/M.png';

				objImageOr = new Image();
        objImageOr.src = 'img/O.png';

				objImageBottom = new Image();
        objImageBottom.src = 'img/B.png';


    }

    // Un cycle d'animation
    function animer() {
        // Requête pour le prochain cycle
        objCycleAnimation = requestAnimationFrame(animer);
    		// Le cycle d'animation
    		effacerDessin();
    		mettreAjourAnimation();
    		dessiner();
	}

    // Arrêter l'animation
	function arreterAnimation() {
	    if (objCycleAnimation != null)
	        cancelAnimationFrame(objCycleAnimation);
	}

	// Pour effacer le dessin
	function effacerDessin() {
		objC2D.clearRect(0,0, objCanvas.width, objCanvas.height);
	}

	// Pour mettre à jour l'animation
	function mettreAjourAnimation(){

	}

	// Pour dessiner
	function dessiner() {
	    dessinerMappe();
	}

	// Pour dessiner l'image de fond
	function dessinerMappe() {
	    objC2D.save();  // Sauvegarde le contexte
      var intTailleTuile = 40;
			var intTuileX = intTailleTuile;
      var intTuileY = intTailleTuile;

      for (var row = 0; row < tabMappe.length; row++) {
        for (var col = 0; col < tabMappe[row].length; col++) {
          intTuileX = col * intTailleTuile;
					intTuileY = row * intTailleTuile;

          switch (tabMappe[row][col]) {
            case 'F': objC2D.drawImage(objImageFond, intTuileX, intTuileY, 40, 40);
              break;

            case 'E': objC2D.drawImage(objImageEchelle, intTuileX, intTuileY, 40, 40);
              break;

            case 'C': objC2D.drawImage(objImageCorde, intTuileX, intTuileY, 40, 40);
              break;

            case 'M': objC2D.drawImage(objImageMur, intTuileX, intTuileY, 40, 40);
              break;

            case 'O': objC2D.drawImage(objImageOr, intTuileX, intTuileY, 40, 40);
              break;

            case 'B': objC2D.drawImage(objImageBottom, intTuileX, intTuileY, 40, 40);
              break;

          }
        }
      }
	    objC2D.restore(); // Restaure le contexte
	}
   </script>
</head>

<body onload="initAnimation()">
	<canvas id="monCanvas" width="1120" height="680" style="display: block; margin: auto;">
		Votre navigateur ne supporte pas la balise canvas
	</canvas
</body>

</html>
